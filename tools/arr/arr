#!/usr/bin/env python3
"""
arr - Unified CLI for managing *arr services (Sonarr, Radarr, Lidarr).

This tool provides a consistent interface for common operations across
the *arr media management stack.
"""

import sys
from pathlib import Path

import click

# Add the arr package directory to Python path
ARR_DIR = Path(__file__).parent.resolve()
sys.path.insert(0, str(ARR_DIR))


@click.group()
def cli():
    """Unified CLI for managing *arr services (Sonarr, Radarr, Lidarr).

    This tool provides a consistent interface for common operations across
    the *arr media management stack.
    """
    pass


@cli.group()
def sonarr():
    """Manage Sonarr TV series."""
    pass


@cli.group()
def radarr():
    """Manage Radarr movies."""
    pass


@cli.group()
def lidarr():
    """Manage Lidarr music."""
    pass


@sonarr.command()
@click.argument("url")
@click.argument("api_key")
@click.option("--dry-run", is_flag=True, help="Show what would be changed without making changes")
@click.option("--no-confirm", "--yolo", is_flag=True, help="Skip interactive confirmation (use with caution)")
def rename(url, api_key, dry_run, no_confirm):
    """Rename series episodes.

    Examples:
        arr sonarr rename http://localhost:8989 your-api-key
        arr sonarr rename http://localhost:8989 your-api-key --dry-run
    """
    from commands import sonarr_rename
    sonarr_rename.run(url, api_key, dry_run, no_confirm)


@radarr.command()
@click.argument("url")
@click.argument("api_key")
@click.option("--dry-run", is_flag=True, help="Show what would be changed without making changes")
@click.option("--no-confirm", "--yolo", is_flag=True, help="Skip interactive confirmation (use with caution)")
def rename(url, api_key, dry_run, no_confirm):
    """Rename movies.

    Examples:
        arr radarr rename http://localhost:7878 your-api-key
        arr radarr rename http://localhost:7878 your-api-key --dry-run
    """
    from commands import radarr_rename
    radarr_rename.run(url, api_key, dry_run, no_confirm)


@lidarr.command("rename-albums")
@click.argument("url")
@click.argument("api_key")
@click.option("--dry-run", is_flag=True, help="Show what would be changed without making changes")
@click.option("--no-confirm", "--yolo", is_flag=True, help="Skip interactive confirmation (use with caution)")
def lidarr_rename_albums(url, api_key, dry_run, no_confirm):
    """Rename albums.

    Examples:
        arr lidarr rename-albums http://localhost:8686 your-api-key
        arr lidarr rename-albums http://localhost:8686 your-api-key --dry-run
    """
    from commands import lidarr_rename_albums
    lidarr_rename_albums.run(url, api_key, dry_run, no_confirm)


@lidarr.command("retag-albums")
@click.argument("url")
@click.argument("api_key")
@click.option("--dry-run", is_flag=True, help="Show what would be changed without making changes")
@click.option("--no-confirm", "--yolo", is_flag=True, help="Skip interactive confirmation (use with caution)")
def lidarr_retag_albums(url, api_key, dry_run, no_confirm):
    """Retag albums metadata.

    Examples:
        arr lidarr retag-albums http://localhost:8686 your-api-key
        arr lidarr retag-albums http://localhost:8686 your-api-key --dry-run
    """
    from commands import lidarr_retag_albums
    lidarr_retag_albums.run(url, api_key, dry_run, no_confirm)


@lidarr.command("update-paths")
@click.argument("url")
@click.argument("api_key")
@click.argument("music_folder")
@click.option("--dry-run", is_flag=True, help="Show what would be updated without making changes")
def lidarr_update_paths(url, api_key, music_folder, dry_run):
    """Update library paths.

    Examples:
        arr lidarr update-paths http://localhost:8686 your-api-key /data/music
        arr lidarr update-paths http://localhost:8686 your-api-key /data/music --dry-run
    """
    from commands import lidarr_update_paths
    lidarr_update_paths.run(url, api_key, music_folder, dry_run)


if __name__ == "__main__":
    cli()
